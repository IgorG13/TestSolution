function parseDate(n){var r=n.split(" "),u,t,f,i;if(r.length===2)return(u=r[0],t=u.split("/"),t.length!==3)?void 0:(f=r[1],i=f.split(":"),i.length!==2)?void 0:new Date(t[0],t[1],t[2],i[0],i[1])}function isOrderValid(n,t,i){return n&&n!==""&&t&&t!==""&&!isNaN(i)}var carsApp,ordersApp;$("#orderdate").datetimepicker({format:"DD/MM/YYYY HH:mm"});carsApp=angular.module("carsApp",[]);carsApp.service("cars",function(){function t(n,t){var i=n.cars.indexOf(t);i>-1&&n.cars.splice(i,1)}function i(n,t){switch(n.status){case 401:alert("Security key is wrong!");break;default:alert(t)}}function n(n){return"Error: "+n.status+" "+n.statusText+"!"}this.getCars=function(t,i){t.get("/cars").then(function(n){i.cars=n.data;i.showCars=!0;i.loading=!1},function(t){alert(n(t))})};this.addCar=function(r,u,f){r.post("/cars/add/"+u.key,f).then(function(n){f.id=n.data.id},function(r){i(r,n(r)+" Car "+f.model+" was not added!");t(u,f)})};this.deleteCar=function(r,u,f){r.get("/cars/delete/"+f.id+"?key="+u.key).then(function(){t(u,f)},function(t){i(t,n(t)+" Car "+f.model+" was not deleted!")})}});carsApp.controller("carsController",function(n,t,i){function r(n){return n!==null&&n.model!==""&&!isNaN(n.price)&&!isNaN(n.engineCapacity)}n.cars=[];n.loading=!0;n.showCars=!1;i.getCars(t,n);n.addCar=function(u,f,e,o){o=parseFloat(o);e=parseFloat(e);var s={model:f,price:o,engineCapacity:e,id:""};r(s)&&(n.cars.push(s),i.addCar(t,n,s))};n.deleteCar=function(r){i.deleteCar(t,n,r)}});ordersApp=angular.module("ordersApp",[]);ordersApp.service("orders",function(){function n(n){return"Error: "+n.status+" "+n.statusText+"!"}this.getCarsForSale=function(n,t){n.get("/orders/cars").then(function(n){t.cars=n.data;t.hideSelectCar=!1})};this.getOrders=function(t,i){t.get("/orders").then(function(n){i.orders=n.data;i.loading=!1;i.showOrders=!0},function(t){alert(n(t))})};this.addOrder=function(t,i){t.post("/orders/add",i).then(function(n){i.id=n.data.id;i.carInfo=n.data.carInfo},function(t){alert(n(t))})};this.deleteOrder=function(t,i,r){var u=i.orders.indexOf(r);u>-1&&t.get("/orders/delete/"+r.id).then(function(){i.orders.splice(u,1)},function(t){alert(n(t))})};this.showStatistic=function(t){t.get("/orders/statistic").then(function(n){alert(n.data)},function(t){alert(n(t))})}});ordersApp.controller("ordersController",function(n,t,i){n.parent={checkOut:""};n.hideSelectCar=!0;n.loading=!0;n.showOrders=!1;i.getCarsForSale(t,n);i.getOrders(t,n);n.addOrder=function(r,u,f){var o,e;u=$("#orderdate").find("input").val();o=parseDate(u);isOrderValid(f,r,o)&&(e={carID:r,orderNumber:f,orderDate:u,carInfo:"Loading..."},n.orders.push(e),i.addOrder(t,e))};n.deleteOrder=function(r){i.deleteOrder(t,n,r)};n.showStatistic=function(){i.showStatistic(t)}});